
import pytest
import warnings
import build_xrds
import numpy as np



def test_get_tidal_pred():
    obs = build_xrds.get_tidal_pred(loc='JI',
                                     img_time=dt.datetime(2014, 4, 7, hour=15, minute=14, second=32),
                                     model_path='/home/jovyan/pyTMD/models',
                                     model='AOTIM-5-2018', epsg=3413)
    exp = [[np.arange(0, 24*60*60, 5*60)], np.array([ 0.36411742,  0.37831734,  0.39203103,  0.4052404 ,  0.41792851,
        0.43007961,  0.44167915,  0.45271384,  0.46317166,  0.47304188,
        0.48231506,  0.49098309,  0.49903916,  0.50647779,  0.5132948 ,
        0.5194873 ,  0.5250537 ,  0.52999364,  0.53430803,  0.53799896,
        0.54106971,  0.54352468,  0.54536937,  0.54661032,  0.54725511,
        0.54731222,  0.54679106,  0.5457019 ,  0.54405578,  0.54186448,
        0.53914045,  0.53589678,  0.53214709,  0.52790553,  0.52318667,
        0.51800548,  0.51237724,  0.50631753,  0.49984214,  0.492967  ,
        0.48570821,  0.4780819 ,  0.47010425,  0.46179141,  0.45315951,
        0.44422455,  0.43500244,  0.42550893,  0.4157596 ,  0.40576982,
        0.39555477,  0.38512937,  0.37450832,  0.36370606,  0.35273677,
        0.34161437,  0.33035251,  0.3189646 ,  0.3074638 ,  0.295863  ,
        0.28417487,  0.27241186,  0.26058622,  0.24870997,  0.23679498,
        0.22485295,  0.21289543,  0.20093384,  0.18897949,  0.17704361,
        0.16513732,  0.15327171,  0.14145781,  0.1297066 ,  0.11802906,
        0.10643615,  0.09493882,  0.08354804,  0.07227475,  0.06112994,
        0.05012456,  0.0392696 ,  0.02857602,  0.01805478,  0.0077168 ,
       -0.00242703, -0.01236589, -0.02208903, -0.03158581, -0.04084571,
       -0.04985838, -0.05861363, -0.06710151, -0.07531231, -0.0832366 ,
       -0.0908653 , -0.09818966, -0.10520133, -0.11189243, -0.11825551,
       -0.12428368, -0.12997059, -0.13531047, -0.1402982 , -0.14492934,
       -0.14920012, -0.15310755, -0.15664937, -0.15982415, -0.16263127,
       -0.16507095, -0.1671443 , -0.1688533 , -0.17020084, -0.1711907 ,
       -0.17182762, -0.1721172 , -0.172066  , -0.17168148, -0.170972  ,
       -0.16994679, -0.16861597, -0.16699051, -0.16508217, -0.16290352,
       -0.16046787, -0.15778927, -0.1548824 , -0.15176261, -0.14844579,
       -0.14494838, -0.14128728, -0.1374798 , -0.13354362, -0.12949669,
       -0.12535721, -0.12114352, -0.1168741 , -0.11256741, -0.10824192,
       -0.103916  , -0.09960782, -0.09533536, -0.0911163 , -0.08696794,
       -0.0829072 , -0.0789505 , -0.07511376, -0.07141228, -0.06786076,
       -0.0644732 , -0.0612629 , -0.05824238, -0.05542336, -0.05281674,
       -0.05043256, -0.04827997, -0.04636722, -0.04470166, -0.0432897 ,
       -0.04213681, -0.04124754, -0.0406255 , -0.04027337, -0.04019294,
       -0.04038507, -0.04084975, -0.04158613, -0.04259249, -0.04386635,
       -0.04540443, -0.04720271, -0.04925649, -0.0515604 , -0.05410846,
       -0.05689409, -0.05991021, -0.06314923, -0.06660312, -0.07026347,
       -0.07412151, -0.07816816, -0.0823941 , -0.08678977, -0.09134546,
       -0.09605131, -0.1008974 , -0.10587372, -0.11097028, -0.11617706,
       -0.12148414, -0.12688164, -0.1323598 , -0.13790896, -0.14351963,
       -0.14918246, -0.15488828, -0.16062812, -0.16639316, -0.17217482,
       -0.17796469, -0.18375455, -0.1895364 , -0.19530239, -0.20104486,
       -0.20675632, -0.21242941, -0.21805694, -0.22363179, -0.22914697,
       -0.23459556, -0.23997071, -0.2452656 , -0.25047342, -0.25558736,
       -0.26060059, -0.26550623, -0.27029735, -0.2749669 , -0.27950777,
       -0.28391269, -0.2881743 , -0.29228506, -0.2962373 , -0.30002317,
       -0.30363467, -0.30706361, -0.31030165, -0.31334028, -0.31617081,
       -0.31878443, -0.32117215, -0.32332491, -0.32523349, -0.32688861,
       -0.32828095, -0.32940111, -0.33023974, -0.33078746, -0.33103501,
       -0.33097318, -0.33059294, -0.32988542, -0.32884196, -0.32745418,
       -0.32571402, -0.32361375, -0.32114605, -0.31830406, -0.31508138,
       -0.31147218, -0.30747118, -0.30307376, -0.29827594, -0.29307444,
       -0.28746675, -0.28145112, -0.27502663, -0.2681932 , -0.26095161,
       -0.25330355, -0.24525162, -0.23679938, -0.2279513 , -0.21871285,
       -0.20909043, -0.19909142, -0.18872418, -0.177998  , -0.16692314,
       -0.15551078, -0.14377301, -0.13172281, -0.11937402, -0.10674132,
       -0.09384017, -0.0806868 , -0.06729813, -0.05369178, -0.03988596,
       -0.02589947, -0.01175162,  0.00253783,  0.01694871,  0.03146049,
        0.04605239,  0.06070339,  0.0753923 ])]
    assert all(obs == exp)